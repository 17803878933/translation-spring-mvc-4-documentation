<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>异步请求的处理 | Spring MVC中文文档翻译稿 - Chinese Translation for Spring MVC Reference Documentation</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.1.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../../publish/21-3/5-testing-controllers.html" />
    
    
    <link rel="prev" href="../../publish/21-3/3-defining-@requestmapping-handler-methods.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="3.4" data-basepath="../.." data-revision="Mon Jun 13 2016 15:23:39 GMT+0800 (CST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="publish/21-1/introduction-to-spring-web-mvc-framework.html">
            
                
                    <a href="../../publish/21-1/introduction-to-spring-web-mvc-framework.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Spring Web MVC框架简介
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="publish/21-1/1-features-of-spring-web-mvc.html">
            
                
                    <a href="../../publish/21-1/1-features-of-spring-web-mvc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Spring Web MVC的特性
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="publish/21-1/2-pluggability-of-other-mvc-implementations.html">
            
                
                    <a href="../../publish/21-1/2-pluggability-of-other-mvc-implementations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        允许其他MVC实现
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="publish/21-2/the-dispatcher-servlet.html">
            
                
                    <a href="../../publish/21-2/the-dispatcher-servlet.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        DispatcherServlet
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="publish/21-2/1-special-bean-types-in-the-webapplicationcontext.html">
            
                
                    <a href="../../publish/21-2/1-special-bean-types-in-the-webapplicationcontext.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        WebApplicationContext中特别的Bean类型
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="publish/21-2/2-default-dispatcherservlet-configuration.html">
            
                
                    <a href="../../publish/21-2/2-default-dispatcherservlet-configuration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        默认的DispatcherServlet配置
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="publish/21-2/3-dispatcherservlet-processing-sequence.html">
            
                
                    <a href="../../publish/21-2/3-dispatcherservlet-processing-sequence.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        DispatcherServlet的处理流程
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="publish/21-3/implementing-controllers.html">
            
                
                    <a href="../../publish/21-3/implementing-controllers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        控制器的实现
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="publish/21-3/1-defining-a-controller-with-@controller.html">
            
                
                    <a href="../../publish/21-3/1-defining-a-controller-with-@controller.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        使用@Controller注解定义一个控制器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="publish/21-3/2-mapping-requests-with-@requestmapping.html">
            
                
                    <a href="../../publish/21-3/2-mapping-requests-with-@requestmapping.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        使用@RequestMapping注解映射请求路径
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="publish/21-3/3-defining-@requestmapping-handler-methods.html">
            
                
                    <a href="../../publish/21-3/3-defining-@requestmapping-handler-methods.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        定义@RequestMapping注解的处理方法
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="3.4" data-path="publish/21-3/4-asynchronous-request-processing.html">
            
                
                    <a href="../../publish/21-3/4-asynchronous-request-processing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        异步请求的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="publish/21-3/5-testing-controllers.html">
            
                
                    <a href="../../publish/21-3/5-testing-controllers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        对控制器测试
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="publish/21-4/handler-mappings.html">
            
                
                    <a href="../../publish/21-4/handler-mappings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        处理器映射
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="publish/21-4/1-intercepting-requests-with-a-handler-interceptor.html">
            
                
                    <a href="../../publish/21-4/1-intercepting-requests-with-a-handler-interceptor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        使用HandlerInterceptor拦截请求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="publish/21-5/resolving-views.html">
            
                
                    <a href="../../publish/21-5/resolving-views.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        视图解析
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="publish/21-5/1-resolving-views-with-the-view-resolver-interface.html">
            
                
                    <a href="../../publish/21-5/1-resolving-views-with-the-view-resolver-interface.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        使用ViewResolver接口解析视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="publish/21-5/2-chaining-view-resolvers.html">
            
                
                    <a href="../../publish/21-5/2-chaining-view-resolvers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        视图链
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="publish/21-5/3-redirecting-to-views.html">
            
                
                    <a href="../../publish/21-5/3-redirecting-to-views.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        视图重定向
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="publish/21-5/4-content-negotiating-view-resolver.html">
            
                
                    <a href="../../publish/21-5/4-content-negotiating-view-resolver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        内容协商解析器ContentNegotiatingViewResolver
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="publish/21-6/using-flash-attributes.html">
            
                
                    <a href="../../publish/21-6/using-flash-attributes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        使用闪存属性FlashAttributes
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="publish/21-7/building-uris.html">
            
                
                    <a href="../../publish/21-7/building-uris.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        URI构造
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="publish/21-7/1-building-uris-to-controllers-and-methods.html">
            
                
                    <a href="../../publish/21-7/1-building-uris-to-controllers-and-methods.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        为控制器和方法指定URI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="publish/21-7/2-building-uris-to-controllers-and-methods-from-views.html">
            
                
                    <a href="../../publish/21-7/2-building-uris-to-controllers-and-methods-from-views.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        在视图中为控制器和方法指定URI
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="publish/21-8/using-locales.html">
            
                
                    <a href="../../publish/21-8/using-locales.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        地区信息
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="publish/21-8/1-obtaining-time-zone-information.html">
            
                
                    <a href="../../publish/21-8/1-obtaining-time-zone-information.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        获取时区信息
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="publish/21-8/2-accept-header-locale-resolver.html">
            
                
                    <a href="../../publish/21-8/2-accept-header-locale-resolver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Accept请求头解析器AcceptHeaderLocaleResolver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="publish/21-8/3-cookie-locale-resolver.html">
            
                
                    <a href="../../publish/21-8/3-cookie-locale-resolver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Cookie解析器CookieLocaleResolver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="publish/21-8/4-session-locale-resolver.html">
            
                
                    <a href="../../publish/21-8/4-session-locale-resolver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Session解析器SessionLocaleResolver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="publish/21-8/5-locale-change-interceptor.html">
            
                
                    <a href="../../publish/21-8/5-locale-change-interceptor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        地区更改拦截器LocaleChangeInterceptor
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="publish/21-9/using-themes.html">
            
                
                    <a href="../../publish/21-9/using-themes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        主题 themes
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="publish/21-9/1-overview-of-themes.html">
            
                
                    <a href="../../publish/21-9/1-overview-of-themes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        关于主题：概览
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="publish/21-9/2-defining-themes.html">
            
                
                    <a href="../../publish/21-9/2-defining-themes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        定义主题
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="publish/21-9/3-theme-resolvers.html">
            
                
                    <a href="../../publish/21-9/3-theme-resolvers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        主题解析器
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="publish/21-10/springs-multipart-file-upload-support.html">
            
                
                    <a href="../../publish/21-10/springs-multipart-file-upload-support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Spring的多路传输（文件上传）支持
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="publish/21-10/1-introduction.html">
            
                
                    <a href="../../publish/21-10/1-introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        概述
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="publish/21-10/2-using-a-multipart-resolver-with-commons-fileupload.html">
            
                
                    <a href="../../publish/21-10/2-using-a-multipart-resolver-with-commons-fileupload.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                        使用MultipartResolver与Commons FileUpload传输文件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="publish/21-10/3-using-a-multipart-resolver-with-servlet-3.html">
            
                
                    <a href="../../publish/21-10/3-using-a-multipart-resolver-with-servlet-3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.3.</b>
                        
                        Servlet 3.0下的MultipartResolver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="publish/21-10/4-handling-a-file-upload-in-a-form.html">
            
                
                    <a href="../../publish/21-10/4-handling-a-file-upload-in-a-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.4.</b>
                        
                        处理表单中的文件上传
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.5" data-path="publish/21-10/5-handling-a-file-upload-request-from-programmatic-clients.html">
            
                
                    <a href="../../publish/21-10/5-handling-a-file-upload-request-from-programmatic-clients.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.5.</b>
                        
                        处理客户端发起的文件上传请求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="publish/21-11/handling-exceptions.html">
            
                
                    <a href="../../publish/21-11/handling-exceptions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        异常处理
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="11.1" data-path="publish/21-11/1-handler-exception-handler.html">
            
                
                    <a href="../../publish/21-11/1-handler-exception-handler.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                        处理器异常解析器HandlerExceptionHandler
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="publish/21-11/2-@exception-handler.html">
            
                
                    <a href="../../publish/21-11/2-@exception-handler.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.</b>
                        
                        @ExceptionHandler注解
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="publish/21-11/3-handling-standard-spring-mvc-exceptions.html">
            
                
                    <a href="../../publish/21-11/3-handling-standard-spring-mvc-exceptions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.3.</b>
                        
                        处理一般的Spring MVC异常
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.4" data-path="publish/21-11/4-annotating-business-exceptions-with-@response-status.html">
            
                
                    <a href="../../publish/21-11/4-annotating-business-exceptions-with-@response-status.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.4.</b>
                        
                        使用@ResponseStatus注解业务异常
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.5" data-path="publish/21-11/5-customizing-the-default-servlet-container-error-page.html">
            
                
                    <a href="../../publish/21-11/5-customizing-the-default-servlet-container-error-page.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.5.</b>
                        
                        Servlet默认容器错误页面的定制化
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="12" data-path="publish/21-12/web-security.html">
            
                
                    <a href="../../publish/21-12/web-security.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Web安全
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="publish/21-13/convention-over-configuration-support.html">
            
                
                    <a href="../../publish/21-13/convention-over-configuration-support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        &quot;约定优于配置&quot;的支持
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="13.1" data-path="publish/21-13/1-the-controller-controller-class-name-handler-mapping.html">
            
                
                    <a href="../../publish/21-13/1-the-controller-controller-class-name-handler-mapping.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.1.</b>
                        
                        控制器类名-处理器映射ControllerClassNameHandlerMapping
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="publish/21-13/2-the-model-modelmap-modelandview.html">
            
                
                    <a href="../../publish/21-13/2-the-model-modelmap-modelandview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.2.</b>
                        
                        模型ModelMap(ModelAndView)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13.3" data-path="publish/21-13/3-the-view-request-to-view-name-translator.html">
            
                
                    <a href="../../publish/21-13/3-the-view-request-to-view-name-translator.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.3.</b>
                        
                        视图-请求与视图名的映射
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="14" data-path="publish/21-14/http-caching-support.html">
            
                
                    <a href="../../publish/21-14/http-caching-support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        HTTP缓存支持
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="14.1" data-path="publish/21-14/1-cache-control-http-header.html">
            
                
                    <a href="../../publish/21-14/1-cache-control-http-header.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.1.</b>
                        
                        HTTP请求头Cache-Control
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14.2" data-path="publish/21-14/2-http-caching-support-for-static-resources.html">
            
                
                    <a href="../../publish/21-14/2-http-caching-support-for-static-resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.2.</b>
                        
                        对静态资源的HTTP缓存支持
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14.3" data-path="publish/21-14/3-support-for-the-cache-control-etag-and-last-modified-response-header-in-controllers.html">
            
                
                    <a href="../../publish/21-14/3-support-for-the-cache-control-etag-and-last-modified-response-header-in-controllers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.3.</b>
                        
                        在控制器中设置Cache-Control、ETag和Last-Modified响应头
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14.4" data-path="publish/21-14/4-shallow-etag-support.html">
            
                
                    <a href="../../publish/21-14/4-shallow-etag-support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.4.</b>
                        
                        忽略ETag
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="15" data-path="publish/21-15/code-based-servlet-container-initialization.html">
            
                
                    <a href="../../publish/21-15/code-based-servlet-container-initialization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        基于代码的Servlet容器初始化
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="publish/21-16/configuring-spring-mvc.html">
            
                
                    <a href="../../publish/21-16/configuring-spring-mvc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        配置Spring MVC
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.1" data-path="publish/21-16/1-enabling-the-mvc-java-config-or-the-mvc-xml-namespace.html">
            
                
                    <a href="../../publish/21-16/1-enabling-the-mvc-java-config-or-the-mvc-xml-namespace.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.1.</b>
                        
                        启用MVC Java编程配置或MVC命名空间配置方式
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.2" data-path="publish/21-16/2-customizing-the-provided-configuration.html">
            
                
                    <a href="../../publish/21-16/2-customizing-the-provided-configuration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.2.</b>
                        
                        默认配置的定制化
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.3" data-path="publish/21-16/3-conversion-and-formatting.html">
            
                
                    <a href="../../publish/21-16/3-conversion-and-formatting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.3.</b>
                        
                        转换与格式化
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.4" data-path="publish/21-16/4-validation.html">
            
                
                    <a href="../../publish/21-16/4-validation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.4.</b>
                        
                        验证
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.5" data-path="publish/21-16/5-interceptors.html">
            
                
                    <a href="../../publish/21-16/5-interceptors.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.5.</b>
                        
                        拦截器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.6" data-path="publish/21-16/6-content-negotiation.html">
            
                
                    <a href="../../publish/21-16/6-content-negotiation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.6.</b>
                        
                        内容协商
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.7" data-path="publish/21-16/7-view-controllers.html">
            
                
                    <a href="../../publish/21-16/7-view-controllers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.7.</b>
                        
                        视图控制器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.8" data-path="publish/21-16/8-view-resolvers.html">
            
                
                    <a href="../../publish/21-16/8-view-resolvers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.8.</b>
                        
                        视图解析器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.9" data-path="publish/21-16/9-serving-of-resources.html">
            
                
                    <a href="../../publish/21-16/9-serving-of-resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.9.</b>
                        
                        资源的服务
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.10" data-path="publish/21-16/10-falling-back-on-the-default-servlet-to-serve-resources.html">
            
                
                    <a href="../../publish/21-16/10-falling-back-on-the-default-servlet-to-serve-resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.10.</b>
                        
                        回到默认的Servlet来进行资源服务
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.11" data-path="publish/21-16/11-path-matching.html">
            
                
                    <a href="../../publish/21-16/11-path-matching.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.11.</b>
                        
                        路径匹配
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.12" data-path="publish/21-16/12-message-converters.html">
            
                
                    <a href="../../publish/21-16/12-message-converters.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.12.</b>
                        
                        消息转换器
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.13" data-path="publish/21-16/13-advanced-customizations-with-mvc-java-config.html">
            
                
                    <a href="../../publish/21-16/13-advanced-customizations-with-mvc-java-config.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.13.</b>
                        
                        使用MVC Java编程进行高级的定制化
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16.14" data-path="publish/21-16/14-advanced-customizations-with-the-mvc-namespace.html">
            
                
                    <a href="../../publish/21-16/14-advanced-customizations-with-the-mvc-namespace.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.14.</b>
                        
                        使用MVC命名空间进行高级的定制化
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Spring MVC中文文档翻译稿 - Chinese Translation for Spring MVC Reference Documentation</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="21-3-4-%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%E7%9A%84%E5%A4%84%E7%90%86">21.3.4 &#x5F02;&#x6B65;&#x8BF7;&#x6C42;&#x7684;&#x5904;&#x7406;</h1>
<p>Spring MVC 3.2&#x5F00;&#x59CB;&#x5F15;&#x5165;&#x4E86;&#x57FA;&#x4E8E;Servlet 3&#x7684;&#x5F02;&#x6B65;&#x8BF7;&#x6C42;&#x5904;&#x7406;&#x3002;&#x76F8;&#x6BD4;&#x4EE5;&#x524D;&#xFF0C;&#x63A7;&#x5236;&#x5668;&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x4E0D;&#x4E00;&#x5B9A;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x800C;&#x662F;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>java.util.concurrent.Callable</code>&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;Spring MVC&#x6240;&#x7BA1;&#x7406;&#x7684;&#x7EBF;&#x7A0B;&#x6765;&#x4EA7;&#x751F;&#x8FD4;&#x56DE;&#x503C;&#x3002;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;Servlet&#x5BB9;&#x5668;&#x7684;&#x4E3B;&#x7EBF;&#x7A0B;&#x5219;&#x53EF;&#x4EE5;&#x9000;&#x51FA;&#x5E76;&#x91CA;&#x653E;&#x5176;&#x8D44;&#x6E90;&#x4E86;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5141;&#x8BB8;&#x5BB9;&#x5668;&#x53BB;&#x5904;&#x7406;&#x5176;&#x4ED6;&#x7684;&#x8BF7;&#x6C42;&#x3002;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;<code>TaskExecutor</code>&#xFF0C;Spring MVC&#x53EF;&#x4EE5;&#x5728;&#x53E6;&#x5916;&#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;<code>Callable</code>&#x3002;&#x5F53;<code>Callable</code>&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x8BF7;&#x6C42;&#x518D;&#x643A;&#x5E26;<code>Callable</code>&#x8FD4;&#x56DE;&#x7684;&#x503C;&#xFF0C;&#x518D;&#x6B21;&#x88AB;&#x5206;&#x914D;&#x5230;Servlet&#x5BB9;&#x5668;&#x4E2D;&#x6062;&#x590D;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x3002;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x63A7;&#x5236;&#x5668;&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-annotation">@RequestMapping</span>(method=RequestMethod.POST)
<span class="hljs-function"><span class="hljs-keyword">public</span> Callable&lt;String&gt; <span class="hljs-title">processUpload</span><span class="hljs-params">(<span class="hljs-keyword">final</span> MultipartFile file)</span> </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Callable&lt;String&gt;() {
        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
            <span class="hljs-comment">// ...</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;someView&quot;</span>;
        }
    };

}
</code></pre>
<p>&#x53E6;&#x4E00;&#x4E2A;&#x9009;&#x62E9;&#xFF0C;&#x662F;&#x8BA9;&#x63A7;&#x5236;&#x5668;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>DeferredResult</code>&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#x53EF;&#x4EE5;&#x7531;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4EA7;&#x751F;&#xFF0C;&#x4E5F;&#x5305;&#x62EC;&#x90A3;&#x4E9B;&#x4E0D;&#x662F;&#x7531;Spring MVC&#x7BA1;&#x7406;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#x53EF;&#x80FD;&#x662F;&#x4E3A;&#x4E86;&#x54CD;&#x5E94;&#x67D0;&#x4E9B;&#x5916;&#x90E8;&#x4E8B;&#x4EF6;&#x6240;&#x4EA7;&#x751F;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x4E00;&#x6761;JMS&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x4E00;&#x4E2A;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#xFF0C;&#x7B49;&#x7B49;&#x3002;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x63A7;&#x5236;&#x5668;&#x4F5C;&#x4E3A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-annotation">@RequestMapping</span>(<span class="hljs-string">&quot;/quotes&quot;</span>)
<span class="hljs-annotation">@ResponseBody</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> DeferredResult&lt;String&gt; <span class="hljs-title">quotes</span><span class="hljs-params">()</span> </span>{
    DeferredResult&lt;String&gt; deferredResult = <span class="hljs-keyword">new</span> DeferredResult&lt;String&gt;();
    <span class="hljs-comment">// Save the deferredResult somewhere..</span>
    <span class="hljs-keyword">return</span> deferredResult;
}

<span class="hljs-comment">// In some other thread...</span>
deferredResult.setResult(data);
</code></pre>
<p>&#x5982;&#x679C;&#x5BF9;Servlet 3.0&#x7684;&#x5F02;&#x6B65;&#x8BF7;&#x6C42;&#x5904;&#x7406;&#x7279;&#x6027;&#x6CA1;&#x6709;&#x4E86;&#x89E3;&#xFF0C;&#x7406;&#x89E3;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x70B9;&#x56F0;&#x96BE;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x9605;&#x8BFB;&#x4E00;&#x4E0B;&#x524D;&#x8005;&#x7684;&#x6587;&#x6863;&#x5C06;&#x4F1A;&#x5F88;&#x6709;&#x5E2E;&#x52A9;&#x3002;&#x4EE5;&#x4E0B;&#x7ED9;&#x51FA;&#x4E86;&#x8FD9;&#x4E2A;&#x673A;&#x5236;&#x8FD0;&#x4F5C;&#x80CC;&#x540E;&#x7684;&#x4E00;&#x4E9B;&#x539F;&#x7406;&#xFF1A;</p>
<ul>
<li>&#x4E00;&#x4E2A;servlet&#x8BF7;&#x6C42;<code>ServletRequest</code>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;<code>request.startAsync()</code>&#x65B9;&#x6CD5;&#x800C;&#x8FDB;&#x5165;&#x5F02;&#x6B65;&#x6A21;&#x5F0F;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x4E3B;&#x8981;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x8BE5;servlet&#x4EE5;&#x53CA;&#x6240;&#x6709;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x90FD;&#x53EF;&#x4EE5;&#x7ED3;&#x675F;&#xFF0C;&#x4F46;&#x5176;&#x54CD;&#x5E94;&#xFF08;response&#xFF09;&#x4F1A;&#x7559;&#x5F85;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x7ED3;&#x675F;&#x540E;&#x518D;&#x8FD4;&#x56DE;</li>
<li>&#x8C03;&#x7528;<code>request.startAsync()</code>&#x65B9;&#x6CD5;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>AsyncContext</code>&#x5BF9;&#x8C61;&#xFF0C;&#x53EF;&#x7528;&#x5B83;&#x5BF9;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x8FDB;&#x884C;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x63A7;&#x5236;&#x548C;&#x64CD;&#x4F5C;&#x3002;&#x6BD4;&#x5982;&#x8BF4;&#x5B83;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x4E0E;&#x8F6C;&#x5411;&#xFF08;forward&#xFF09;&#x5F88;&#x76F8;&#x4F3C;&#x7684;<code>dispatch</code>&#x65B9;&#x6CD5;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5B83;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x6062;&#x590D;Servlet&#x5BB9;&#x5668;&#x7684;&#x8BF7;&#x6C42;&#x5904;&#x7406;&#x8FDB;&#x7A0B;</li>
<li><code>ServletRequest</code>&#x63D0;&#x4F9B;&#x4E86;&#x83B7;&#x53D6;&#x5F53;&#x524D;<code>DispatherType</code>&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x540E;&#x8005;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x533A;&#x522B;&#x5F53;&#x524D;&#x5904;&#x7406;&#x7684;&#x662F;&#x539F;&#x59CB;&#x8BF7;&#x6C42;&#x3001;&#x5F02;&#x6B65;&#x5206;&#x53D1;&#x8BF7;&#x6C42;&#x3001;&#x8F6C;&#x5411;&#xFF0C;&#x6216;&#x662F;&#x5176;&#x4ED6;&#x7C7B;&#x578B;&#x7684;&#x8BF7;&#x6C42;&#x5206;&#x53D1;&#x7C7B;&#x578B;&#x3002;</li>
</ul>
<p>With the above in mind, the following is the sequence of events for async
request processing with a <code>Callable</code>:</p>
<ul>
<li>Controller returns a <code>Callable</code>.</li>
<li>Spring MVC starts asynchronous processing and submits the <code>Callable</code> to a <code>TaskExecutor</code> for processing in a separate thread.</li>
<li>The <code>DispatcherServlet</code> and all Filter&apos;s exit the Servlet container thread but the response remains open.</li>
<li>The <code>Callable</code> produces a result and Spring MVC dispatches the request back to the Servlet container to resume processing.</li>
<li>The <code>DispatcherServlet</code> is invoked again and processing resumes with the asynchronously produced result from the <code>Callable</code>.</li>
</ul>
<p>The sequence for <code>DeferredResult</code> is very similar except it&apos;s up to the
application to produce the asynchronous result from any thread:</p>
<ul>
<li>Controller returns a <code>DeferredResult</code> and saves it in some in-memory queue or list where it can be accessed.</li>
<li>Spring MVC starts async processing.</li>
<li>The <code>DispatcherServlet</code> and all configured Filter&apos;s exit the request processing thread but the response remains open.</li>
<li>The application sets the <code>DeferredResult</code> from some thread and Spring MVC dispatches the request back to the Servlet container.</li>
<li>The <code>DispatcherServlet</code> is invoked again and processing resumes with the asynchronously produced result.</li>
</ul>
<p>For further background on the motivation for async request processing and when
or why to use it please read <a href="https://spring.io/blog/2012/05/07/spring-mvc-3-2-preview-introducing-
servlet-3-async-support" target="_blank">this blog post
series</a>.</p>
<h4 id="exception-handling-for-async-requests">Exception Handling for Async Requests</h4>
<p>What happens if a <code>Callable</code> returned from a controller method raises an
Exception while being executed? The short answer is the same as what happens
when a controller method raises an exception. It goes through the regular
exception handling mechanism. The longer explanation is that when a <code>Callable</code>
raises an Exception Spring MVC dispatches to the Servlet container with the
<code>Exception</code> as the result and that leads to resume request processing with the
<code>Exception</code> instead of a controller method return value. When using a
<code>DeferredResult</code> you have a choice whether to call <code>setResult</code> or
<code>setErrorResult</code> with an <code>Exception</code> instance.</p>
<h4 id="intercepting-async-requests">Intercepting Async Requests</h4>
<p>A <code>HandlerInterceptor</code> can also implement <code>AsyncHandlerInterceptor</code> in order
to implement the <code>afterConcurrentHandlingStarted</code> callback, which is called
instead of <code>postHandle</code> and <code>afterCompletion</code> when asynchronous processing
starts.</p>
<p>A <code>HandlerInterceptor</code> can also register a <code>CallableProcessingInterceptor</code> or
a <code>DeferredResultProcessingInterceptor</code> in order to integrate more deeply with
the lifecycle of an asynchronous request and for example handle a timeout
event. See the Javadoc of <code>AsyncHandlerInterceptor</code> for more details.</p>
<p>The <code>DeferredResult</code> type also provides methods such as <code>onTimeout(Runnable)</code>
and <code>onCompletion(Runnable)</code>. See the Javadoc of <code>DeferredResult</code> for more
details.</p>
<p>When using a <code>Callable</code> you can wrap it with an instance of <code>WebAsyncTask</code>
which also provides registration methods for timeout and completion.</p>
<h4 id="http-streaming">HTTP Streaming</h4>
<p>A controller method can use <code>DeferredResult</code> and <code>Callable</code> to produce its
return value asynchronously and that can be used to implement techniques such
as <a href="http://spring.io/blog/2012/05/08/spring-mvc-3-2-preview-
techniques-for-real-time-updates/" target="_blank">long polling</a> where the server can push an event to the
client as soon as possible.</p>
<p>What if you wanted to push multiple events on a single HTTP response? This is
a technique related to &quot;Long Polling&quot; that is known as &quot;HTTP Streaming&quot;.
Spring MVC makes this possible through the <code>ResponseBodyEmitter</code> return value
type which can be used to send multiple Objects, instead of one as is normally
the case with <code>@ResponseBody</code>, where each Object sent is written to the
response with an <code>HttpMessageConverter</code>.</p>
<p>Here is an example of that:</p>
<pre><code>_@RequestMapping(&quot;/events&quot;)_
public ResponseBodyEmitter handle() {
    ResponseBodyEmitter emitter = new ResponseBodyEmitter();
    // Save the emitter somewhere..
    return emitter;
}

// In some other thread
emitter.send(&quot;Hello once&quot;);

// and again later on
emitter.send(&quot;Hello again&quot;);

// and done at some point
emitter.complete();
</code></pre><p>Note that <code>ResponseBodyEmitter</code> can also be used as the body in a
<code>ResponseEntity</code> in order to customize the status and headers of the response.</p>
<h4 id="http-streaming-with-server-sent-events">HTTP Streaming With Server-Sent Events</h4>
<p><code>SseEmitter</code> is a sub-class of <code>ResponseBodyEmitter</code> providing support for
<a href="http://www.w3.org/TR/eventsource/" target="_blank">Server-Sent Events</a>. Server-sent events is
a just another variation on the same &quot;HTTP Streaming&quot; technique except events
pushed from the server are formatted according to the W3C Server-Sent Events
specification.</p>
<p>Server-Sent Events can be used for their intended purpose, that is to push
events from the server to clients. It is quite easy to do in Spring MVC and
requires simply returning a value of type <code>SseEmitter</code>.</p>
<p>Note however that Internet Explorer does not support Server-Sent Events and
that for more advanced web application messaging scenarios such as online
games, collaboration, financial applicatinos, and others it&apos;s better to
consider Spring&apos;s WebSocket support that includes SockJS-style WebSocket
emulation falling back to a very wide range of browsers (including Internet
Explorer) and also higher-level messaging patterns for interacting with
clients through a publish-subscribe model within a more messaging-centric
architecture. For further background on this see <a href="http://blog.pivotal.io/pivotal/products/websocket-architecture-in-
spring-4-0" target="_blank">the following blog
post</a>.</p>
<h4 id="http-streaming-directly-to-the-outputstream">HTTP Streaming Directly To The OutputStream</h4>
<p><code>ResponseBodyEmitter</code> allows sending events by writing Objects to the response
through an <code>HttpMessageConverter</code>. This is probably the most common case, for
example when writing JSON data. However sometimes it is useful to bypass
message conversion and write directly to the response <code>OutputStream</code> for
example for a file download. This can be done with the help of the
<code>StreamingResponseBody</code> return value type.</p>
<p>Here is an example of that:</p>
<pre><code>_@RequestMapping(&quot;/download&quot;)_
public StreamingResponseBody handle() {
    return new StreamingResponseBody() {
        _@Override_
        public void writeTo(OutputStream outputStream) throws IOException {
            // write...
        }
    };
}
</code></pre><p>Note that <code>StreamingResponseBody</code> can also be used as the body in a
<code>ResponseEntity</code> in order to customize the status and headers of the response.</p>
<h4 id="configuring-asynchronous-request-processing">Configuring Asynchronous Request Processing</h4>
<h5 id="servlet-container-configuration">Servlet Container Configuration</h5>
<p>For applications configured with a <code>web.xml</code> be sure to update to version 3.0:</p>
<pre><code>&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
            http://java.sun.com/xml/ns/javaee
            http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;
    version=&quot;3.0&quot;&gt;

    ...

&lt;/web-app&gt;
</code></pre><p>Asynchronous support must be enabled on the <code>DispatcherServlet</code> through the
<code>&lt;async-supported&gt;true&lt;/async-supported&gt;</code> web.xml sub-element. Additionally
any <code>Filter</code> that participates in asyncrequest processing must be configured
to support the ASYNC dispatcher type. It should be safe to enable the ASYNC
dispatcher type for all filters provided with the Spring Framework since they
usually extend <code>OncePerRequestFilter</code> and that has runtime checks for whether
the filter needs to be involved in async dispatches or not.</p>
<p>Below is some example web.xml configuration:</p>
<pre><code class="lang-xml">    <span class="hljs-tag">&lt;<span class="hljs-title">web-app</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">&quot;http://java.sun.com/xml/ns/javaee&quot;</span>
        <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
        <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">&quot;
                http://java.sun.com/xml/ns/javaee
                http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>
        <span class="hljs-attribute">version</span>=<span class="hljs-value">&quot;3.0&quot;</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">filter</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">filter-name</span>&gt;</span>Spring OpenEntityManagerInViewFilter<span class="hljs-tag">&lt;/<span class="hljs-title">filter-name</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">filter-class</span>&gt;</span>org.springframework.~.OpenEntityManagerInViewFilter<span class="hljs-tag">&lt;/<span class="hljs-title">filter-class</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">async-supported</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">async-supported</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">filter</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">filter-mapping</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">filter-name</span>&gt;</span>Spring OpenEntityManagerInViewFilter<span class="hljs-tag">&lt;/<span class="hljs-title">filter-name</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dispatcher</span>&gt;</span>REQUEST<span class="hljs-tag">&lt;/<span class="hljs-title">dispatcher</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dispatcher</span>&gt;</span>ASYNC<span class="hljs-tag">&lt;/<span class="hljs-title">dispatcher</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">filter-mapping</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-title">web-app</span>&gt;</span>
</code></pre>
<p>If using Servlet 3, Java based configuration for example via
<code>WebApplicationInitializer</code>, you&apos;ll also need to set the &quot;asyncSupported&quot; flag
as well as the ASYNC dispatcher type just like with <code>web.xml</code>. To simplify all
this configuration, consider extending <code>AbstractDispatcherServletInitializer</code>
or <code>AbstractAnnotationConfigDispatcherServletInitializer</code> which automatically
set those options and make it very easy to register <code>Filter</code> instances.</p>
<h5 id="spring-mvc-configuration">Spring MVC Configuration</h5>
<p>The MVC Java config and the MVC namespace provide options for configuring
asynchronous request processing. <code>WebMvcConfigurer</code> has the method
<code>configureAsyncSupport</code> while <code>&lt;mvc:annotation-driven&gt;</code> has an <code>&lt;async-
support&gt;</code> sub-element.</p>
<p>Those allow you to configure the default timeout value to use for async
requests, which if not set depends on the underlying Servlet container (e.g.
10 seconds on Tomcat). You can also configure an <code>AsyncTaskExecutor</code> to use
for executing <code>Callable</code> instances returned from controller methods. It is
highly recommended to configure this property since by default Spring MVC uses
<code>SimpleAsyncTaskExecutor</code>. The MVC Java config and the MVC namespace also
allow you to register <code>CallableProcessingInterceptor</code> and
<code>DeferredResultProcessingInterceptor</code> instances.</p>
<p>If you need to override the default timeout value for a specific
<code>DeferredResult</code>, you can do so by using the appropriate class constructor.
Similarly, for a <code>Callable</code>, you can wrap it in a <code>WebAsyncTask</code> and use the
appropriate class constructor to customize the timeout value. The class
constructor of <code>WebAsyncTask</code> also allows providing an <code>AsyncTaskExecutor</code>.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../publish/21-3/3-defining-@requestmapping-handler-methods.html" class="navigation navigation-prev " aria-label="Previous page: 定义@RequestMapping注解的处理方法"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../publish/21-3/5-testing-controllers.html" class="navigation navigation-next " aria-label="Next page: 对控制器测试"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
